# Maintainer  : Edgar Hucek <gimli at dark green dot com>

_pluginname=dxr3
pkgname=vdr-plugin-$_pluginname-git
pkgver=0.2.9
revision=1
pkgrel=1
gitid=0c7b22bab46d63a0aa37039c76038fe9af3dadbe
arch=(i686 x86_64)
pkgdesc="Dxr3 VDR-Plugin"
url="http://projects.vdr-developer.org/projects/show/plg-dxr3"
license="GPL"
makedepends=('vdr' 'git')
depends=('vdr' 'gettext' 'pkgconfig' 'ffmpeg' 'em8300')
backup=()
source=()
md5sums=()

build() {
#  unset CXXFLAGS

  cd ${srcdir}

  _githost="git://projects.vdr-developer.org"
  _gitrepo="vdr-plugin-dxr3.git"

  if [ -e $srcdir/vdr-plugin-${_pluginname} ]; then	  
    cd $srcdir/vdr-plugin-${_pluginname}
    git rebase origin
    git checkout $gitid
  else
    git clone ${_githost}/${_gitrepo}
    cd $srcdir/vdr-plugin-${_pluginname}
    git checkout $gitid
  fi

  if [ -e $srcdir/vdr-plugin-${_pluginname}-build ]; then
    rm -rf $srcdir/vdr-plugin-${_pluginname}-build
  fi

  cp -r $srcdir/vdr-plugin-${_pluginname} $srcdir/vdr-plugin-${_pluginname}-build

  cd $srcdir/vdr-plugin-${_pluginname}-build

  mkdir -p $pkgdir/usr/lib/vdr/plugins/ || return 1

  make VDRDIR=/usr/include/vdr \
       LIBDIR=. \
       LOCALEDIR="$startdir/pkg/usr/share/locale/" all || return 1
  
  mkdir -p $pkgdir/usr/lib/vdr/plugins						|| return 1
  install -m 755 libvdr-*.so.*		$pkgdir/usr/lib/vdr/plugins/		|| return 1

}

